<!--
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

    <title>Dippaeditori</title>

    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">

</head>
<body>

<div id="center_wrapper_outer">
    <div id="center_wrapper_inner">
        <div id="editor" style="width: 800px">Loading content...</div>
    </div>
</div>

<div id="toolbar">

</div>

<!--

-->

<!--
<div style="position: absolute; bottom: 0px;">
    <button id="save">Save</button> <a href="dippa.pdf">PDF preview</a>
</div>
<div style="position: absolute; bottom: 0px;">

</div>

</body>
</html>
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Bootstrap, from Twitter</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="css/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
</head>

<body>

<div class="topbar">
    <div class="fill">
        <div class="container">
            <a class="brand" href="#">Dippa editor</a>
            <ul class="nav">
                <li class="active"><a href="#">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            <button id="save_button" class="btn danger" data-loading-text="saving document...">Save</button>
            <button id="preview_button" class="btn info">Preview</button>
        </div>
    </div>
</div>

<div class="container" style="height: 100%">

    <div style="width: 900px; height: 100%; position: relative">
        <div style="position: absolute; top: 60px; bottom: 20px; left: 0; right: 0">
            <div id="editor" style="width: 900px; height: 100%"></div>
        </div>
    </div>

</div> <!-- /container -->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="scripts/bootstrap-buttons.js"></script>
<script src="src/ace-unmin.js" type="text/javascript" charset="utf-8"></script>
<script src="src/mode-latex.js" type="text/javascript" charset="utf-8"></script>
<script>

    $(function() {
        var editor = ace.edit("editor");

        editor.setShowPrintMargin(false);

        $('#save_button').click(function() {
            var $saveButton = $(this);

            $saveButton.button('loading');
            var value = JSON.stringify({value: editor.getSession().getValue()});

            $.ajax({
                type: "POST",
                url: '/save',
                dataType: 'json',
                contentType: 'application/json',
                data: value,
                processData: false,
                complete: function(response) {
                    $saveButton.button('reset');
                }
            });
        });

        $('#preview_button').click(function() {
            window.location = "PPBqWA9.pdf";
        });

        $.ajax({
            url: '/load',
            success: function(content) {
                var session = editor.getSession();

                session.setValue(content);
                var LatexMode = require("ace/mode/latex").Mode;
                session.setMode(new LatexMode());

                session.setUseWrapMode(true);
            }
        });
    });

</script>

</body>
</html>
